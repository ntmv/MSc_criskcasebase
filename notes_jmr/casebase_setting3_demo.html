<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.306">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nirupama Tamvada">

<title>Looking at Setting 3: Mixture of Effects</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="casebase_setting3_demo_files/libs/clipboard/clipboard.min.js"></script>
<script src="casebase_setting3_demo_files/libs/quarto-html/quarto.js"></script>
<script src="casebase_setting3_demo_files/libs/quarto-html/popper.min.js"></script>
<script src="casebase_setting3_demo_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="casebase_setting3_demo_files/libs/quarto-html/anchor.min.js"></script>
<link href="casebase_setting3_demo_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="casebase_setting3_demo_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="casebase_setting3_demo_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="casebase_setting3_demo_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="casebase_setting3_demo_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="casebase_setting3_demo_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="casebase_setting3_demo_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Looking at Setting 3: Mixture of Effects</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nirupama Tamvada </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="setting-3-mixture-of-effects-in-a-high-dimensional-setting" class="level2">
<h2 class="anchored" data-anchor-id="setting-3-mixture-of-effects-in-a-high-dimensional-setting">Setting 3: Mixture of Effects in a high-dimensional setting</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(casebase)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future.apply)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mtool)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreach)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmprsk)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pec)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting functions </span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"~/Desktop/MSc_criskcasebase/src/fitting_functions.R"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>run_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(seed) {</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>seed <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># take the last five digits of the initial seed</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>the_seed<span class="ot">=</span> seed <span class="sc">%%</span> <span class="dv">100000</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(the_seed)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">400</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>num_true <span class="ot">&lt;-</span> <span class="dv">24</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, p))</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>beta2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, p))</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>nu_ind <span class="ot">&lt;-</span> <span class="fu">seq</span>(num_true)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>nu_ind <span class="ot">&lt;-</span> <span class="fu">seq</span>(num_true)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>beta1[nu_ind] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">6</span>), <span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>))</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>beta2[nu_ind] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>), <span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">6</span>))</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate data</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>sim.data <span class="ot">&lt;-</span> <span class="fu">cause_hazards_sim</span>(<span class="at">n =</span> n, <span class="at">p =</span> p, <span class="at">nblocks =</span> <span class="dv">4</span>, <span class="at">num.true =</span> <span class="dv">24</span>, </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>                              <span class="at">beta1 =</span> beta1, <span class="at">beta2 =</span> beta2, <span class="at">rate_cens =</span> <span class="fl">0.05</span>, </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>                              <span class="at">h1 =</span> <span class="fl">0.55</span>, <span class="at">h2 =</span> <span class="fl">0.35</span>, <span class="at">gamma1 =</span> <span class="fl">1.5</span>, <span class="at">gamma2 =</span> <span class="fl">1.5</span>)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Censoring proportion</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>cen.prop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(sim.data<span class="sc">$</span>fstatus)), <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Training-test split </span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>train.index <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">createDataPartition</span>(sim.data<span class="sc">$</span>fstatus, <span class="at">p =</span> <span class="fl">0.75</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> sim.data[train.index,]</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> sim.data[<span class="sc">-</span>train.index,]</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="do">######################## Fit cox-regression model ###############################</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="do">######################### Cause-1 #########################################</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Censor competing event</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>y_train1 <span class="ot">&lt;-</span> <span class="fu">Surv</span>(<span class="at">time =</span> train<span class="sc">$</span>ftime, <span class="at">event =</span> train<span class="sc">$</span>fstatus <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>x_train1 <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> . <span class="sc">-</span>ftime <span class="sc">-</span>fstatus, <span class="at">data =</span> train)[, <span class="sc">-</span><span class="dv">1</span>] </span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Censor competing event</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>y_test1 <span class="ot">&lt;-</span> <span class="fu">Surv</span>(<span class="at">time =</span> test<span class="sc">$</span>ftime, <span class="at">event =</span> test<span class="sc">$</span>fstatus <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>x_test1 <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> . <span class="sc">-</span>ftime <span class="sc">-</span>fstatus, <span class="at">data =</span> test)[, <span class="sc">-</span><span class="dv">1</span>] </span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit cause-specific cox model with glmnet on training set </span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>cox_mod1 <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(<span class="at">x =</span> x_train1, <span class="at">y =</span> y_train1, <span class="at">family =</span> <span class="st">"cox"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit on validation set </span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>cox_val_min1 <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> x_test1, <span class="at">y =</span> y_test1, <span class="at">family =</span> <span class="st">"cox"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, </span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>                       <span class="at">lambda =</span> cox_mod1<span class="sc">$</span>lambda.min)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>cc_min1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(cox_val_min1)</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>res_cox_min1 <span class="ot">&lt;-</span> <span class="fu">varsel_perc</span>(cc_min1, beta1)</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="co"># MSE</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>mse_cox <span class="ot">&lt;-</span> <span class="fu">mean</span>((cc_min1[<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>] <span class="sc">-</span> beta1[<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="co"># True coefs</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>cc_true <span class="ot">&lt;-</span> cc_min1[<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>]</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a><span class="do">########################## Cause 2 #####################################</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Censor competing event</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>y_train2 <span class="ot">&lt;-</span> <span class="fu">Surv</span>(<span class="at">time =</span> train<span class="sc">$</span>ftime, <span class="at">event =</span> train<span class="sc">$</span>fstatus <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>x_train2 <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> . <span class="sc">-</span>ftime <span class="sc">-</span>fstatus, <span class="at">data =</span> train)[, <span class="sc">-</span><span class="dv">1</span>] </span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Censor competing event</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>y_test2 <span class="ot">&lt;-</span> <span class="fu">Surv</span>(<span class="at">time =</span> test<span class="sc">$</span>ftime, <span class="at">event =</span> test<span class="sc">$</span>fstatus <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>x_test2 <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> . <span class="sc">-</span>ftime <span class="sc">-</span>fstatus, <span class="at">data =</span> test)[, <span class="sc">-</span><span class="dv">1</span>] </span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit cause-specific cox model with glmnet on training set </span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>cox_mod2 <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(<span class="at">x =</span> x_train2, <span class="at">y =</span> y_train2, <span class="at">family =</span> <span class="st">"cox"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>)</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit on validation set </span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>cox_val_min2 <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> x_test2, <span class="at">y =</span> y_test2, <span class="at">family =</span> <span class="st">"cox"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, </span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>                       <span class="at">lambda =</span> cox_mod2<span class="sc">$</span>lambda.min)</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>cc_min2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(cox_val_min2)</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>res_cox_min2 <span class="ot">&lt;-</span> <span class="fu">varsel_perc</span>(cc_min2, beta2)</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a><span class="do">########################## Fit casebase model #################################</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Train case-base model </span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>cv.lambda <span class="ot">&lt;-</span> <span class="fu">mtool.multinom.cv</span>(train, <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">nfold =</span> <span class="dv">5</span>, <span class="at">train_ratio =</span> <span class="dv">20</span>)</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>cv.lambda</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a><span class="co"># Test set </span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>surv_obj_val <span class="ot">&lt;-</span> <span class="fu">with</span>(test, <span class="fu">Surv</span>(ftime, <span class="fu">as.numeric</span>(fstatus), <span class="at">type =</span> <span class="st">"mstate"</span>))</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="co"># Covariance matrix</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>cov_val <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test[, <span class="fu">c</span>(<span class="fu">grepl</span>(<span class="st">"X"</span>, <span class="fu">colnames</span>(test)))], <span class="at">time =</span> <span class="fu">log</span>(test<span class="sc">$</span>ftime))</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a><span class="co"># Case-base dataset</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>cb_data_val <span class="ot">&lt;-</span> <span class="fu">create_cbDataset</span>(surv_obj_val, <span class="fu">as.matrix</span>(cov_val), <span class="at">ratio =</span> <span class="dv">10</span>)</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a><span class="co"># Case-base fits </span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Lambda.min</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>fit_val_min <span class="ot">&lt;-</span> <span class="fu">fit_cbmodel</span>(cb_data_val, <span class="at">regularization =</span> <span class="st">'elastic-net'</span>,</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>                           <span class="at">lambda =</span> cv.lambda<span class="sc">$</span>lambda.min , <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">unpen_cov =</span> <span class="dv">2</span>)</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>fit_val_1se <span class="ot">&lt;-</span> <span class="fu">fit_cbmodel</span>(cb_data_val, <span class="at">regularization =</span> <span class="st">'elastic-net'</span>,</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>                           <span class="at">lambda =</span> cv.lambda<span class="sc">$</span>lambda<span class="fl">.1</span>se , <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">unpen_cov =</span> <span class="dv">2</span>)</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>coef_val1 <span class="ot">&lt;-</span> fit_val_min<span class="sc">$</span>coefficients[<span class="dv">1</span><span class="sc">:</span><span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text=</span><span class="st">"p"</span>)), <span class="dv">1</span>]</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>coef_val2 <span class="ot">&lt;-</span> fit_val_min<span class="sc">$</span>coefficients[<span class="dv">1</span><span class="sc">:</span><span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text=</span><span class="st">"p"</span>)), <span class="dv">2</span>]</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>coef_val3 <span class="ot">&lt;-</span> fit_val_1se<span class="sc">$</span>coefficients[<span class="dv">1</span><span class="sc">:</span><span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text=</span><span class="st">"p"</span>)), <span class="dv">1</span>]</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>coef_val4 <span class="ot">&lt;-</span> fit_val_1se<span class="sc">$</span>coefficients[<span class="dv">1</span><span class="sc">:</span><span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text=</span><span class="st">"p"</span>)), <span class="dv">2</span>]</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a><span class="co"># True coefs</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>cb_true_min <span class="ot">&lt;-</span> coef_val1[<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>]</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>cb_true_1se <span class="ot">&lt;-</span> coef_val3[<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>]</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a><span class="co">#coef_val1 &lt;- ifelse(coef_val1 &lt; 1e-05, 0, coef_val1)</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a><span class="co">#coef_val2 &lt;- ifelse(coef_val2 &lt; 1e-05, 0, coef_val2)</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a><span class="co">#coef_val3 &lt;- ifelse(coef_val1 &lt; 1e-05, 0, coef_val1)</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a><span class="co">#coef_val4 &lt;- ifelse(coef_val2 &lt; 1e-05, 0, coef_val2)</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>res_cb_min1 <span class="ot">&lt;-</span> <span class="fu">varsel_perc</span>(coef_val1, beta1)</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>res_cb_min2 <span class="ot">&lt;-</span> <span class="fu">varsel_perc</span>(coef_val2, beta2)</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>res_cb_min3 <span class="ot">&lt;-</span> <span class="fu">varsel_perc</span>(coef_val3, beta1)</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>res_cb_min4 <span class="ot">&lt;-</span> <span class="fu">varsel_perc</span>(coef_val4, beta2)</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a><span class="co"># MSE</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>mse_cb <span class="ot">&lt;-</span> <span class="fu">mean</span>((fit_val_min<span class="sc">$</span>coefficients[<span class="dv">1</span><span class="sc">:</span><span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text=</span><span class="st">"p"</span>)), <span class="dv">1</span>][<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>] <span class="sc">-</span> beta1[<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a><span class="do">###################################################################################</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">rbind</span>(res_cb_min1, res_cb_min2, res_cb_min3, res_cb_min4, res_cox_min1, res_cox_min2,   cen.prop)</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Res) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"casebase.lambda.min_cause1"</span>, <span class="st">"casebase.lambda.min_cause2"</span>,<span class="st">"casebase.lambda.1se_cause1"</span>, <span class="st">"casebase.lambda.1se_cause2"</span>,</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"cox.lambda.min_cause1"</span>, <span class="st">"cox.lambda.min_cause2"</span>, <span class="st">"cens.prop"</span>)</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>Res</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>mse_res <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mse_cox, mse_cb)</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Res =</span> Res, <span class="at">mse_res =</span> mse_res, <span class="at">cc_true =</span> cc_true, <span class="at">cb_true_min =</span> cb_true_min, </span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>            <span class="at">cb_true_1se =</span> cb_true_1se))</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>seeds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">123</span>, <span class="dv">456</span>, <span class="dv">789</span>)</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>results_list <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(seeds, run_simulation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed Fold 1 
Completed Fold 2 
Completed Fold 3 
Completed Fold 4 
Completed Fold 5 

 Iteration 1
Frobenius norm of coefficient update 
5.67298e-05

 Iteration 1
Frobenius norm of coefficient update 
5.66047e-05
Completed Fold 1 
Completed Fold 2 
Completed Fold 3 
Completed Fold 4 
Completed Fold 5 

 Iteration 1
Frobenius norm of coefficient update 
6.17549e-05

 Iteration 1
Frobenius norm of coefficient update 
6.02741e-05
Completed Fold 1 
Completed Fold 2 
Completed Fold 3 
Completed Fold 4 
Completed Fold 5 

 Iteration 1
Frobenius norm of coefficient update 
6.02222e-05

 Iteration 1
Frobenius norm of coefficient update 
6.00856e-05</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Res_all <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map2_dfr</span>(results_list, seeds, <span class="sc">~</span>{</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(.x<span class="sc">$</span>Res) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">rownames</span>(.x<span class="sc">$</span>Res), <span class="at">seed =</span> .y)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>mse_all <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map2_dfr</span>(results_list, seeds, <span class="sc">~</span>{</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(.x<span class="sc">$</span>mse_res) <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"model"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">seed =</span> .y)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>Res_all <span class="sc">%&gt;%</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>, <span class="at">caption =</span> <span class="st">"ðŸ“Š Sensitivity and Specificity Across Seeds"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"400px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:100%; ">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<caption>ðŸ“Š Sensitivity and Specificity Across Seeds</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">TP</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">TN</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">FP</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">FN</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Sensitivity</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Specificity</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">MCC</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">model</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">seed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">casebase.lambda.min_cause1...1</td>
<td style="text-align: right;">8.0000</td>
<td style="text-align: right;">981.0000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.4444444</td>
<td style="text-align: right;">0.9989817</td>
<td style="text-align: right;">0.6242452</td>
<td style="text-align: left;">casebase.lambda.min_cause1</td>
<td style="text-align: right;">123</td>
</tr>
<tr class="even">
<td style="text-align: left;">casebase.lambda.min_cause2...2</td>
<td style="text-align: right;">4.0000</td>
<td style="text-align: right;">988.0000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.3333333</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.5750269</td>
<td style="text-align: left;">casebase.lambda.min_cause2</td>
<td style="text-align: right;">123</td>
</tr>
<tr class="odd">
<td style="text-align: left;">casebase.lambda.1se_cause1...3</td>
<td style="text-align: right;">7.0000</td>
<td style="text-align: right;">980.0000</td>
<td style="text-align: right;">2.000</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.3888889</td>
<td style="text-align: right;">0.9979633</td>
<td style="text-align: right;">0.5446017</td>
<td style="text-align: left;">casebase.lambda.1se_cause1</td>
<td style="text-align: right;">123</td>
</tr>
<tr class="even">
<td style="text-align: left;">casebase.lambda.1se_cause2...4</td>
<td style="text-align: right;">4.0000</td>
<td style="text-align: right;">988.0000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.3333333</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.5750269</td>
<td style="text-align: left;">casebase.lambda.1se_cause2</td>
<td style="text-align: right;">123</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cox.lambda.min_cause1...5</td>
<td style="text-align: right;">12.0000</td>
<td style="text-align: right;">938.0000</td>
<td style="text-align: right;">44.000</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.6666667</td>
<td style="text-align: right;">0.9551935</td>
<td style="text-align: right;">0.3595876</td>
<td style="text-align: left;">cox.lambda.min_cause1</td>
<td style="text-align: right;">123</td>
</tr>
<tr class="even">
<td style="text-align: left;">cox.lambda.min_cause2...6</td>
<td style="text-align: right;">6.0000</td>
<td style="text-align: right;">953.0000</td>
<td style="text-align: right;">35.000</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.9645749</td>
<td style="text-align: right;">0.2551077</td>
<td style="text-align: left;">cox.lambda.min_cause2</td>
<td style="text-align: right;">123</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cens.prop...7</td>
<td style="text-align: right;">0.2500</td>
<td style="text-align: right;">0.4450</td>
<td style="text-align: right;">0.305</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">cens.prop</td>
<td style="text-align: right;">123</td>
</tr>
<tr class="even">
<td style="text-align: left;">casebase.lambda.min_cause1...8</td>
<td style="text-align: right;">12.0000</td>
<td style="text-align: right;">819.0000</td>
<td style="text-align: right;">163.000</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.6666667</td>
<td style="text-align: right;">0.8340122</td>
<td style="text-align: right;">0.1751884</td>
<td style="text-align: left;">casebase.lambda.min_cause1</td>
<td style="text-align: right;">456</td>
</tr>
<tr class="odd">
<td style="text-align: left;">casebase.lambda.min_cause2...9</td>
<td style="text-align: right;">6.0000</td>
<td style="text-align: right;">944.0000</td>
<td style="text-align: right;">44.000</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.9554656</td>
<td style="text-align: right;">0.2275505</td>
<td style="text-align: left;">casebase.lambda.min_cause2</td>
<td style="text-align: right;">456</td>
</tr>
<tr class="even">
<td style="text-align: left;">casebase.lambda.1se_cause1...10</td>
<td style="text-align: right;">11.0000</td>
<td style="text-align: right;">912.0000</td>
<td style="text-align: right;">70.000</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.6111111</td>
<td style="text-align: right;">0.9287169</td>
<td style="text-align: right;">0.2630554</td>
<td style="text-align: left;">casebase.lambda.1se_cause1</td>
<td style="text-align: right;">456</td>
</tr>
<tr class="odd">
<td style="text-align: left;">casebase.lambda.1se_cause2...11</td>
<td style="text-align: right;">6.0000</td>
<td style="text-align: right;">980.0000</td>
<td style="text-align: right;">8.000</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.9919028</td>
<td style="text-align: right;">0.4558752</td>
<td style="text-align: left;">casebase.lambda.1se_cause2</td>
<td style="text-align: right;">456</td>
</tr>
<tr class="even">
<td style="text-align: left;">cox.lambda.min_cause1...12</td>
<td style="text-align: right;">11.0000</td>
<td style="text-align: right;">931.0000</td>
<td style="text-align: right;">51.000</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.6111111</td>
<td style="text-align: right;">0.9480652</td>
<td style="text-align: right;">0.3082787</td>
<td style="text-align: left;">cox.lambda.min_cause1</td>
<td style="text-align: right;">456</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cox.lambda.min_cause2...13</td>
<td style="text-align: right;">6.0000</td>
<td style="text-align: right;">952.0000</td>
<td style="text-align: right;">36.000</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.9635628</td>
<td style="text-align: right;">0.2516345</td>
<td style="text-align: left;">cox.lambda.min_cause2</td>
<td style="text-align: right;">456</td>
</tr>
<tr class="even">
<td style="text-align: left;">cens.prop...14</td>
<td style="text-align: right;">0.2525</td>
<td style="text-align: right;">0.4675</td>
<td style="text-align: right;">0.280</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">cens.prop</td>
<td style="text-align: right;">456</td>
</tr>
<tr class="odd">
<td style="text-align: left;">casebase.lambda.min_cause1...15</td>
<td style="text-align: right;">14.0000</td>
<td style="text-align: right;">910.0000</td>
<td style="text-align: right;">72.000</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.7777778</td>
<td style="text-align: right;">0.9266802</td>
<td style="text-align: right;">0.3340602</td>
<td style="text-align: left;">casebase.lambda.min_cause1</td>
<td style="text-align: right;">789</td>
</tr>
<tr class="even">
<td style="text-align: left;">casebase.lambda.min_cause2...16</td>
<td style="text-align: right;">5.0000</td>
<td style="text-align: right;">972.0000</td>
<td style="text-align: right;">16.000</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.4166667</td>
<td style="text-align: right;">0.9838057</td>
<td style="text-align: right;">0.3041169</td>
<td style="text-align: left;">casebase.lambda.min_cause2</td>
<td style="text-align: right;">789</td>
</tr>
<tr class="odd">
<td style="text-align: left;">casebase.lambda.1se_cause1...17</td>
<td style="text-align: right;">12.0000</td>
<td style="text-align: right;">902.0000</td>
<td style="text-align: right;">80.000</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.6666667</td>
<td style="text-align: right;">0.9185336</td>
<td style="text-align: right;">0.2691905</td>
<td style="text-align: left;">casebase.lambda.1se_cause1</td>
<td style="text-align: right;">789</td>
</tr>
<tr class="even">
<td style="text-align: left;">casebase.lambda.1se_cause2...18</td>
<td style="text-align: right;">6.0000</td>
<td style="text-align: right;">974.0000</td>
<td style="text-align: right;">14.000</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.9858300</td>
<td style="text-align: right;">0.3778552</td>
<td style="text-align: left;">casebase.lambda.1se_cause2</td>
<td style="text-align: right;">789</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cox.lambda.min_cause1...19</td>
<td style="text-align: right;">10.0000</td>
<td style="text-align: right;">976.0000</td>
<td style="text-align: right;">6.000</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.5555556</td>
<td style="text-align: right;">0.9938900</td>
<td style="text-align: right;">0.5821825</td>
<td style="text-align: left;">cox.lambda.min_cause1</td>
<td style="text-align: right;">789</td>
</tr>
<tr class="even">
<td style="text-align: left;">cox.lambda.min_cause2...20</td>
<td style="text-align: right;">6.0000</td>
<td style="text-align: right;">947.0000</td>
<td style="text-align: right;">41.000</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.9585020</td>
<td style="text-align: right;">0.2358930</td>
<td style="text-align: left;">cox.lambda.min_cause2</td>
<td style="text-align: right;">789</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cens.prop...21</td>
<td style="text-align: right;">0.2850</td>
<td style="text-align: right;">0.4100</td>
<td style="text-align: right;">0.305</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">cens.prop</td>
<td style="text-align: right;">789</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mse_all <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>, <span class="at">caption =</span> <span class="st">"ðŸ“ˆ MSE Across Models and Seeds"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"300px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<caption>ðŸ“ˆ MSE Across Models and Seeds</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">model</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">V1</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">seed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mse_cox</td>
<td style="text-align: right;">0.2899574</td>
<td style="text-align: right;">123</td>
</tr>
<tr class="even">
<td style="text-align: left;">mse_cb</td>
<td style="text-align: right;">0.5592192</td>
<td style="text-align: right;">123</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mse_cox</td>
<td style="text-align: right;">0.2656233</td>
<td style="text-align: right;">456</td>
</tr>
<tr class="even">
<td style="text-align: left;">mse_cb</td>
<td style="text-align: right;">0.5519284</td>
<td style="text-align: right;">456</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mse_cox</td>
<td style="text-align: right;">0.4003972</td>
<td style="text-align: right;">789</td>
</tr>
<tr class="even">
<td style="text-align: left;">mse_cb</td>
<td style="text-align: right;">0.5513126</td>
<td style="text-align: right;">789</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>coef_truth_long <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map2_dfr</span>(results_list, seeds, <span class="sc">~</span>{</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> .y,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">index =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">glmnet =</span> <span class="fu">as.numeric</span>(.x<span class="sc">$</span>cc_true),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mtool_min =</span> <span class="fu">as.numeric</span>(.x<span class="sc">$</span>cb_true_min),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mtool_1se =</span> <span class="fu">as.numeric</span>(.x<span class="sc">$</span>cb_true_1se)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(glmnet, mtool_min, mtool_1se),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"method"</span>, <span class="at">values_to =</span> <span class="st">"coefficient"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>coef_truth_long <span class="sc">%&gt;%</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.character)) <span class="sc">%&gt;%</span>  </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>, <span class="at">caption =</span> <span class="st">"ðŸ” Comparison of True Coefficients Across Methods and Seeds"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>), <span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"400px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:100%; ">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<caption>ðŸ” Comparison of True Coefficients Across Methods and Seeds</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">seed</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">index</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">method</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">coefficient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.559974863018278</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.010824914210808</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.0107388204622632</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.00670910343000966</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.00665596570393623</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.688533902558181</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.00466779183304955</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.00463192925888218</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.322592226673911</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.00392851755398014</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.00393513144786643</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.271737029972635</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.00789672529908934</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.00785894915746606</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.415602687348448</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.00548667109978566</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.00544157943420658</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">11</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">11</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">11</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">12</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">-0.0274692136714131</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">12</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">12</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">13</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.307203105459357</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">13</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">5.79321383163335e-07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">13</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">14</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.248024200351304</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">14</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">14</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.146274938673802</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">16</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.44893330097265</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">16</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">9.0384428955633e-07</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">16</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">1.00399503698538e-09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.505071160538698</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.264214813676297</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">19</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">19</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">19</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">20</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">20</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">20</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">21</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">21</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">21</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">22</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">22</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">22</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">23</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">23</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">23</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">24</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123</td>
<td style="text-align: left;">24</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">123</td>
<td style="text-align: left;">24</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.621315412789704</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.00570505280906034</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.00448631630218673</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.130047573096782</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.00883519249682767</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.00769465098868134</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.00268972058377791</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.00143687343791944</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.572672341719221</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">2.11225704177942e-05</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.66705716607732</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.00160204367473685</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.000372819486533069</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.0039499770571875</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.00272724135645406</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">-0.159152934022083</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">11</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">11</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">11</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">12</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">12</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">12</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">13</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.134142339731024</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">13</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.0109207747983073</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">13</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.00970878383961812</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">14</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.659316181928744</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">14</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.0196797677674469</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">14</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.018518617078968</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.449477385880246</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.0191370856113431</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.0179337322242868</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">16</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.547243012839515</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">16</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.0189238916120575</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">16</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.0176492590182495</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.357003317567887</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.0166104892535416</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.0153495514526036</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.833206695892888</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.0198019834851769</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.0186203156098515</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">19</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">19</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">1.88246966270541e-07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">19</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">20</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">20</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">20</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">21</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">21</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">21</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">22</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">22</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">22</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">23</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">23</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">23</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">24</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">456</td>
<td style="text-align: left;">24</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">456</td>
<td style="text-align: left;">24</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.00892071187579514</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.00892321053824947</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.344008342351296</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.016259586589939</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.0162135288184972</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.323454499928791</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.0153922368309304</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.0153426313398274</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.174846195717617</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.0108085636213291</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.0108800994685607</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.312713961913012</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.0167292994012058</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.0167031896550162</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.000267627488559397</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.0105580654488528</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.0105737829436748</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">1.35135384894854e-06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">1.89628948478947e-06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">11</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">11</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">11</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">12</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">12</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">12</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">13</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">13</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.00532627858259001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">13</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.00526991306642474</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">14</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.233014714569184</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">14</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.013827256990317</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">14</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.013819756478769</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.249562549093855</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.0150592110474252</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.0151359985934593</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">16</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.191664475315859</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">16</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.00413440042353179</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">16</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.00396247347716905</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.274926813225537</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.0110090372038987</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.010824581937157</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0.140798704271098</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0.0070842845841273</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0.00689080288993953</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">19</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">19</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">19</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">20</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">20</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">20</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">21</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">21</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">21</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">22</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">22</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">22</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">23</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">23</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">23</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">24</td>
<td style="text-align: left;">glmnet</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">789</td>
<td style="text-align: left;">24</td>
<td style="text-align: left;">mtool_min</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">789</td>
<td style="text-align: left;">24</td>
<td style="text-align: left;">mtool_1se</td>
<td style="text-align: left;">0</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"==== Sensitivity &amp; Specificity Across Runs ===="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "==== Sensitivity &amp; Specificity Across Runs ===="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Res_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                     TP       TN      FP FN Sensitivity
casebase.lambda.min_cause1...1   8.0000 981.0000   1.000 10   0.4444444
casebase.lambda.min_cause2...2   4.0000 988.0000   0.000  8   0.3333333
casebase.lambda.1se_cause1...3   7.0000 980.0000   2.000 11   0.3888889
casebase.lambda.1se_cause2...4   4.0000 988.0000   0.000  8   0.3333333
cox.lambda.min_cause1...5       12.0000 938.0000  44.000  6   0.6666667
cox.lambda.min_cause2...6        6.0000 953.0000  35.000  6   0.5000000
cens.prop...7                    0.2500   0.4450   0.305  0   0.0000000
casebase.lambda.min_cause1...8  12.0000 819.0000 163.000  6   0.6666667
casebase.lambda.min_cause2...9   6.0000 944.0000  44.000  6   0.5000000
casebase.lambda.1se_cause1...10 11.0000 912.0000  70.000  7   0.6111111
casebase.lambda.1se_cause2...11  6.0000 980.0000   8.000  6   0.5000000
cox.lambda.min_cause1...12      11.0000 931.0000  51.000  7   0.6111111
cox.lambda.min_cause2...13       6.0000 952.0000  36.000  6   0.5000000
cens.prop...14                   0.2525   0.4675   0.280  0   0.0000000
casebase.lambda.min_cause1...15 14.0000 910.0000  72.000  4   0.7777778
casebase.lambda.min_cause2...16  5.0000 972.0000  16.000  7   0.4166667
casebase.lambda.1se_cause1...17 12.0000 902.0000  80.000  6   0.6666667
casebase.lambda.1se_cause2...18  6.0000 974.0000  14.000  6   0.5000000
cox.lambda.min_cause1...19      10.0000 976.0000   6.000  8   0.5555556
cox.lambda.min_cause2...20       6.0000 947.0000  41.000  6   0.5000000
cens.prop...21                   0.2850   0.4100   0.305  0   0.0000000
                                Specificity       MCC
casebase.lambda.min_cause1...1    0.9989817 0.6242452
casebase.lambda.min_cause2...2    1.0000000 0.5750269
casebase.lambda.1se_cause1...3    0.9979633 0.5446017
casebase.lambda.1se_cause2...4    1.0000000 0.5750269
cox.lambda.min_cause1...5         0.9551935 0.3595876
cox.lambda.min_cause2...6         0.9645749 0.2551077
cens.prop...7                     0.0000000 0.0000000
casebase.lambda.min_cause1...8    0.8340122 0.1751884
casebase.lambda.min_cause2...9    0.9554656 0.2275505
casebase.lambda.1se_cause1...10   0.9287169 0.2630554
casebase.lambda.1se_cause2...11   0.9919028 0.4558752
cox.lambda.min_cause1...12        0.9480652 0.3082787
cox.lambda.min_cause2...13        0.9635628 0.2516345
cens.prop...14                    0.0000000 0.0000000
casebase.lambda.min_cause1...15   0.9266802 0.3340602
casebase.lambda.min_cause2...16   0.9838057 0.3041169
casebase.lambda.1se_cause1...17   0.9185336 0.2691905
casebase.lambda.1se_cause2...18   0.9858300 0.3778552
cox.lambda.min_cause1...19        0.9938900 0.5821825
cox.lambda.min_cause2...20        0.9585020 0.2358930
cens.prop...21                    0.0000000 0.0000000
                                                     model seed
casebase.lambda.min_cause1...1  casebase.lambda.min_cause1  123
casebase.lambda.min_cause2...2  casebase.lambda.min_cause2  123
casebase.lambda.1se_cause1...3  casebase.lambda.1se_cause1  123
casebase.lambda.1se_cause2...4  casebase.lambda.1se_cause2  123
cox.lambda.min_cause1...5            cox.lambda.min_cause1  123
cox.lambda.min_cause2...6            cox.lambda.min_cause2  123
cens.prop...7                                    cens.prop  123
casebase.lambda.min_cause1...8  casebase.lambda.min_cause1  456
casebase.lambda.min_cause2...9  casebase.lambda.min_cause2  456
casebase.lambda.1se_cause1...10 casebase.lambda.1se_cause1  456
casebase.lambda.1se_cause2...11 casebase.lambda.1se_cause2  456
cox.lambda.min_cause1...12           cox.lambda.min_cause1  456
cox.lambda.min_cause2...13           cox.lambda.min_cause2  456
cens.prop...14                                   cens.prop  456
casebase.lambda.min_cause1...15 casebase.lambda.min_cause1  789
casebase.lambda.min_cause2...16 casebase.lambda.min_cause2  789
casebase.lambda.1se_cause1...17 casebase.lambda.1se_cause1  789
casebase.lambda.1se_cause2...18 casebase.lambda.1se_cause2  789
cox.lambda.min_cause1...19           cox.lambda.min_cause1  789
cox.lambda.min_cause2...20           cox.lambda.min_cause2  789
cens.prop...21                                   cens.prop  789</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"==== MSE for Each Model Across Runs ===="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "==== MSE for Each Model Across Runs ===="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mse_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    model        V1 seed
1 mse_cox 0.2899574  123
2  mse_cb 0.5592192  123
3 mse_cox 0.2656233  456
4  mse_cb 0.5519284  456
5 mse_cox 0.4003972  789
6  mse_cb 0.5513126  789</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"==== True Coefficients from Each Method ===="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "==== True Coefficients from Each Method ===="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(coef_truth_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 216 Ã— 4
    seed index method    coefficient
   &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;           &lt;dbl&gt;
 1   123     1 glmnet        0.560  
 2   123     1 mtool_min     0.0108 
 3   123     1 mtool_1se     0.0107 
 4   123     2 glmnet        0      
 5   123     2 mtool_min     0.00671
 6   123     2 mtool_1se     0.00666
 7   123     3 glmnet        0.689  
 8   123     3 mtool_min     0.00467
 9   123     3 mtool_1se     0.00463
10   123     4 glmnet        0.323  
# â„¹ 206 more rows</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>